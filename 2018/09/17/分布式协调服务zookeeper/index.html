<!DOCTYPE html>
<html lang="zh-CN">
<head>
  <link rel="stylesheet" href="/style/style.css">
<script>
  var nlviconfig = {
    title: "Lincy's Blog",
    author: "Lincy",
    baseUrl: "/",
    theme: {
      scheme: "banderole",
      lightbox: true,
      animate: true,
      search: true,
      friends: false,
      reward: false,
      lazy: false
    }
  }
</script>




    <link rel="stylesheet" href="/script/lib/lightbox/css/lightbox.min.css">




    <link rel="stylesheet" href="/syuanpi/syuanpi.min.css">











<meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="browsermode" content="application">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-title" content="Lincy's Blog">
<meta name="apple-mobile-web-app-status-bar-style" content="default">
<meta name="msapplication-navbutton-color" content="#666666">
<meta name= "format-detection" content="telephone=no" />
<meta name="keywords" content="nlvi, Nlvi" />


  <meta name="subtitle" content="归去来兮，Just Do IT.">




  <title> 分布式协调服务zookeeper · Lincy's Blog </title>
</head>
<body>
  <div class="progress">
  <div class="progress-inner"></div>
</div>

  
    <div class="tagcloud-mask"></div>  
<div class="tagcloud" id="tagcloud">
  <div class="tagcloud-inner">
    <a href="/tags/JDK源码/" style="font-size: 14px;">JDK源码</a> <a href="/tags/JVM/" style="font-size: 14px;">JVM</a> <a href="/tags/python/" style="font-size: 14px;">python</a> <a href="/tags/springboot/" style="font-size: 14px;">springboot</a> <a href="/tags/vim/" style="font-size: 14px;">vim</a> <a href="/tags/zookeeper/" style="font-size: 14px;">zookeeper</a> <a href="/tags/分布式/" style="font-size: 14px;">分布式</a> <a href="/tags/笔记/" style="font-size: 14px;">笔记</a> <a href="/tags/行摄/" style="font-size: 14px;">行摄</a> <a href="/tags/设计模式/" style="font-size: 14px;">设计模式</a>
  </div>
</div>
  

  <div class="container" style="display:none;">

    <header class="header" id="header">
  <div class="header-wrapper">
    <div class="logo">
  <div class="logo-inner syuanpi tvIn">
    <span><a href="/">Lincy's Blog</a></span>
    
      <span id="subtitle">归去来兮，Just Do IT.</span>
    
  </div>
</div>
    <nav class="main-nav">
  
  <ul class="main-nav-list syuanpi tvIn">
  
    <li class="menu-item">
      <a href="javascript:;" id="search">
        <span>搜索</span>
        
          <span class="menu-item-label">search</span>
        
      </a>
    </li>
  
  
    
      
    
    <li class="menu-item">
      <a href="/" id="article">
        <span class="base-name">文章</span>
        
          <span class="menu-item-label">article</span>
        
      </a>
    </li>
  
    
      
    
    <li class="menu-item">
      <a href="/archives" id="archives">
        <span class="base-name">归档</span>
        
          <span class="menu-item-label">archives</span>
        
      </a>
    </li>
  
    
      
    
    <li class="menu-item">
      <a href="javascript:;" id="tags">
        <span class="base-name">标签</span>
        
          <span class="menu-item-label">tags</span>
        
      </a>
    </li>
  
    
      
    
    <li class="menu-item">
      <a href="/about" id="about">
        <span class="base-name">关于</span>
        
          <span class="menu-item-label">about</span>
        
      </a>
    </li>
  
  </ul>
  
</nav>

    
    
  </div>
</header>
<div class="mobile-header">
  <div class="mobile-header-body">
    <div class="mobile-header-list">
      
        
            <div class="mobile-nav-item">
                <a href="/">
                    <span>文章</span>
                    
                        <span class="menu-item-label">article</span>
                    
                </a>
            </div>
        
      
        
            <div class="mobile-nav-item">
                <a href="/archives">
                    <span>归档</span>
                    
                        <span class="menu-item-label">archives</span>
                    
                </a>
            </div>
        
      
        
          <div class="mobile-nav-item inner-cloud">
            <div class="mobile-nav-tag">
              <a href="javascript:;" id="mobile-tags">
                <span>标签</span>
                
                    <span class="menu-item-label">tags</span>
                
              </a>
            </div>
            <div class="mobile-nav-tagcloud">
              <div class="mobile-tagcloud-inner">
                <a href="/tags/JDK源码/" style="font-size: 14px;">JDK源码</a> <a href="/tags/JVM/" style="font-size: 14px;">JVM</a> <a href="/tags/python/" style="font-size: 14px;">python</a> <a href="/tags/springboot/" style="font-size: 14px;">springboot</a> <a href="/tags/vim/" style="font-size: 14px;">vim</a> <a href="/tags/zookeeper/" style="font-size: 14px;">zookeeper</a> <a href="/tags/分布式/" style="font-size: 14px;">分布式</a> <a href="/tags/笔记/" style="font-size: 14px;">笔记</a> <a href="/tags/行摄/" style="font-size: 14px;">行摄</a> <a href="/tags/设计模式/" style="font-size: 14px;">设计模式</a>
              </div>
            </div>
          </div>
        
      
        
            <div class="mobile-nav-item">
                <a href="/about">
                    <span>关于</span>
                    
                        <span class="menu-item-label">about</span>
                    
                </a>
            </div>
        
      
    </div>
  </div>
  <div class="mobile-header-nav">
    <div class="mobile-header-item" id="mobile-left">
      <div class="header-menu-item">
        <span class="header-menu-line"></span>
      </div>
    </div>
    <h1 class="mobile-header-title">
      <a href="/">Lincy's Blog</a>
    </h1>
    <div class="mobile-header-item"></div>
  </div>
</div>
    <div class="container-inner">
      <main class="main" id="main">
        <div class="main-wrapper">
          
    
  
  <article class="
  post
   is_post 
  ">
    <header class="post-header">
      <div class="post-time syuanpi fadeInUpShort back-1">
        <div class="post-time-wrapper">
          <span>2018-09-17</span>
          
          
            
          
        </div>
      </div>
      <h1 class="post-title syuanpi fadeInUpShort back-2">
        
          分布式协调服务zookeeper
        
      </h1>
    </header>
    <div class="post-content syuanpi fadeInUpShort back-3">
      
        <h3 id="分布式环境的特点"><a href="#分布式环境的特点" class="headerlink" title="分布式环境的特点"></a>分布式环境的特点</h3><ul>
<li>分布式</li>
<li>并发性<br>程序运行过程中，并发性操作是很常见的。比如同一个分布式系统中的多个节点，同时访问一个共享资源。数据库、分布式存储。</li>
<li>无序性<br>进程间的消息通信，会出现顺序不一致的情况。</li>
</ul>
<a id="more"></a>
<h3 id="分布式面临的问题"><a href="#分布式面临的问题" class="headerlink" title="分布式面临的问题"></a>分布式面临的问题</h3><ul>
<li>网络通信<br>网络本身不可靠</li>
<li>网络分区（脑裂）<br>当网络发生异常导致分布式系统中部分节点之间的网络延时不断增大，<strong>最终导致组成分布式架构的所有节点，只有部分节点能够正常通信</strong>。</li>
<li>三态<br>成功、失败、<strong>超时</strong></li>
<li>分布式事务<br>ACID（原子性、一致性、隔离性、持久性）</li>
</ul>
<h3 id="中心化和去中心化"><a href="#中心化和去中心化" class="headerlink" title="中心化和去中心化"></a>中心化和去中心化</h3><p>冷备或者热备</p>
<p>分布式架构里面，很多的架构思想采用的是：当集群发生故障的时候，集群中的人群会自动“选举”出一个新的领导。<br>最典型的是： zookeeper / etcd</p>
<h3 id="CAP-BASE-理论"><a href="#CAP-BASE-理论" class="headerlink" title="CAP/BASE 理论"></a>CAP/BASE 理论</h3><h4 id="CAP"><a href="#CAP" class="headerlink" title="CAP"></a>CAP</h4><p>C（一致性Consistency）：所有节点上的数据，时刻保持一致<br>A（可用性Availability）：每个请求都能够收到一个响应，无论响应成功或者失败<br>P（分区容错Partition-tolerance）：表示系统出现脑裂以后，可能导致某些Server与集群中的其他机器失去联系</p>
<p>CP / AP</p>
<p>CAP理论仅适用于原子读写的Nosql场景，不适用于数据库系统</p>
<h4 id="BASE"><a href="#BASE" class="headerlink" title="BASE"></a>BASE</h4><p>基于CAP理论，CAP理论并不适用于数据库事务（因为更新一些错误的数据而导致数据出现紊乱，无论什么样的数据库高可用方案都是<br>徒劳） ，虽然XA事务可以保证数据库在分布式系统下的ACID特性，但是会带来性能方面的影响；</p>
<p>eBay尝试了一种完全不同的套路，放宽了对事务ACID的要求。提出了BASE理论<br><strong>Basically available</strong>  ： 数据库采用分片模式， 把100W的用户数据分布在5个实例上。如果破坏了其中一个实例，仍然可以保证<br>80%的用户可用</p>
<p><strong>soft-state</strong>：  在基于client-server模式的系统中，server端是否有状态，决定了系统是否具备良好的水平扩展、负载均衡、故障恢复等特性。<br>Server端承诺会维护client端状态数据，这个状态仅仅维持一小段时间, 这段时间以后，server端就会丢弃这个状态，恢复正常状态</p>
<p><strong>Eventually consistent</strong>：数据的最终一致性</p>
<h3 id="zookeeper能做什么"><a href="#zookeeper能做什么" class="headerlink" title="zookeeper能做什么"></a>zookeeper能做什么</h3><p>数据的发布/订阅（配置中心:disconf）<br>负载均衡（dubbo利用了zookeeper机制实现负载均衡）<br>命名服务<br>master选举(kafka、hadoop、hbase)<br>分布式队列<br>分布式锁</p>
<h3 id="zookeeper的特性"><a href="#zookeeper的特性" class="headerlink" title="zookeeper的特性"></a>zookeeper的特性</h3><ul>
<li><strong>顺序一致性</strong><br>从同一个客户端发起的事务请求，最终会严格按照顺序被应用到zookeeper中。</li>
<li><strong>原子性</strong><br>所有的事务请求的处理结果在整个集群中的所有机器上的应用情况是一致的，也就是说，要么整个集群中的所有机器都成功应用了某一事务，要么全都不应用</li>
<li><strong>可靠性</strong><br>一旦服务器成功应用了某一个事务数据，并且对客户端做了响应，那么这个数据在整个集群中一定是同步并且保留下来的。</li>
<li><strong>实时性</strong><br>一旦一个事务被成功应用，客户端就能够立即从服务器端读取到事务变更后的最新数据状态；（<strong>zookeeper仅仅保证在一定时间内，近实时</strong>）</li>
</ul>
<h3 id="zookeeper-安装"><a href="#zookeeper-安装" class="headerlink" title="zookeeper 安装"></a>zookeeper 安装</h3><h4 id="单机环境安装"><a href="#单机环境安装" class="headerlink" title="单机环境安装"></a>单机环境安装</h4><ol>
<li>下载zookeeper的安装包<br><a href="http://apache.fayea.com/zookeeper/stable/zookeeper-3.4.10.tar.gz" target="_blank" rel="noopener">http://apache.fayea.com/zookeeper/stable/zookeeper-3.4.10.tar.gz</a></li>
<li>解压zookeeper<br>tar -zxvf zookeeper-3.4.10.tar.gz</li>
<li>cd 到 ZK_HOME/conf  , copy一份zoo.cfg<br>cp  zoo_sample.cfg  zoo.cfg</li>
<li>sh zkServer.sh<br>{start|start-foreground|stop|restart|status|upgrade|print-cmd}</li>
<li>sh zkCli.sh -server  ip:port</li>
</ol>
<h4 id="集群环境"><a href="#集群环境" class="headerlink" title="集群环境"></a>集群环境</h4><p>zookeeper集群, 包含三种角色: <strong>leader / follower /observer</strong></p>
<p><strong>observer</strong> 是一种特殊的zookeeper节点。可以帮助解决zookeeper的扩展性（如果大量客户端访问我们zookeeper集群，需要增加zookeeper集群机器数量。从而增加zookeeper集群的性能。 导致zookeeper写性能下降， zookeeper的数据变更需要半数以上服务器投票通过。造成网络消耗增加投票成本）</p>
<ol>
<li>observer不参与投票。 只接收投票结果。</li>
<li>不属于zookeeper的关键部位。</li>
</ol>
<p><img src="/2018/09/17/分布式协调服务zookeeper/2018-09-18-03-51-36.png" alt=""></p>
<p><strong>集群配置</strong></p>
<p>每一行此配置表示一个集群中的一台服务器。其中id为Server ID，用来标识该机器在集群中的编号。同时，在所在服务器的数据目录（/tmp/zookeeper）下创建一个myid文件，该文件只有一行内容，并且是一个数字，就是对应每台服务器的Server ID数字。</p>
<p>比如server.1=IP1:2888:3888的myid中的内容就是1。不同服务器的ID需要保持不同，并且和zoo.cfg文件中server.id中的id和myid文件的内容保持一致。id的取值范围为1~255。</p>
<p>其中，server.id中配置参数的<strong>第一个port是集群中其他机器与Leader之间通信的端口</strong>，<strong>第二个port为当Leader宕机或其他故障时，集群进行重新选举Leader时使用的端口</strong>。</p>
<p>按照以上相同步骤，配置集群中的其他机器。每个集群的zoo.cfg文件都是相同的，可通过版本控制或其他工具保证每台zookeeper服务器的配置文件相同。集群中每台机器唯一不同的是server.id对应的myid文件中的数字不同。server.id=host:port:port<br>id的取值范围： 1~255； 用id来标识该机器在集群中的机器序号<br><strong>2182是follower节点与leader节点交换信息的端口号；<br>3181表示leader节点挂掉了, 需要一个端口来重新选举。</strong></p>
<p>server.1=192.168.11.129:2182:3181<br>server.2=192.168.11.131:2182:3181<br>server.3=192.168.11.135:2182:3181</p>
<p><strong>observer配置</strong></p>
<p>peerType=observer<br>server.1=192.168.11.129:2182:3181:observer<br>server.2=192.168.11.131:2182:3181<br>server.3=192.168.11.135:2182:3181</p>
<p><strong>zoo.cfg</strong></p>
<p>tickTime=2000  zookeeper中最小的时间单位长度 （ms）</p>
<p>initLimit=10  follower节点启动后与leader节点完成数据同步的时间</p>
<p>syncLimit=5 leader节点和follower节点进行心跳检测的最大延时时间</p>
<p>dataDir=/tmp/zookeeper  表示zookeeper服务器存储快照文件的目录</p>
<p>dataLogDir 表示配置 zookeeper事务日志的存储路径，默认指定在dataDir目录下</p>
<p>clientPort 表示客户端和服务端建立连接的端口号： 2181</p>
<h3 id="zookeeper-的一些概念"><a href="#zookeeper-的一些概念" class="headerlink" title="zookeeper 的一些概念"></a>zookeeper 的一些概念</h3><p>zookeeper的数据模型和文件系统类似，每一个节点称为：<strong>znode</strong>.  是zookeeper中的最小数据单元。每一个znode上都可以 <strong>保存数据和挂载子节点</strong>。 从而构成一个层次化的属性结构</p>
<p><strong>节点特性</strong>：</p>
<ul>
<li><strong>持久化节点</strong>  ： 节点创建后会一直存在zookeeper服务器上，直到主动删除</li>
<li><strong>持久化有序节点</strong> ：每个节点都会为它的一级子节点维护一个顺序</li>
<li><strong>临时节点</strong> ： 临时节点的生命周期和客户端的会话保持一致。当客户端会话失效，该节点自动清理</li>
<li><strong>临时有序节点</strong> ： 在临时节点上多了一个顺序性特性</li>
</ul>
<h3 id="zookee-的命令操作"><a href="#zookee-的命令操作" class="headerlink" title="zookee 的命令操作"></a>zookee 的命令操作</h3><ol>
<li>create [-s] [-e] path data acl<br>-s 表示节点是否有序<br>-e 表示是否为临时节点<br>默认情况下，是持久化节点</li>
</ol>
<blockquote>
<p><strong>ACL</strong><br>  zookeeper提供控制节点访问权限的功能，用于有效的保证zookeeper中数据的安全性。避免误操作而导致系统出现重大事故。<br>  CREATE /READ/WRITE/DELETE/ADMIN</p>
</blockquote>
<ol>
<li>get path [watch]<br>获得指定 path的信息<blockquote>
<p> <strong>Watcher</strong><br>zookeeper提供了分布式数据发布/订阅,zookeeper允许客户端向服务器注册一个watcher监听。当服务器端的节点触发指定事件的时候会触发watcher。服务端会向客户端发送一个事件通知 <strong>watcher的通知是一次性，一旦触发一次通知后，该watcher就失效</strong></p>
</blockquote>
</li>
</ol>
<ol>
<li><p>set path data [version]<br>修改节点 path对应的data<br>乐观锁的概念<br>数据库里面有一个 version 字段去控制数据行的版本号</p>
<figure class="image-bubble">
                <div class="img-lightbox">
                    <div class="overlay"></div>
                    <img src="/2018/09/17/分布式协调服务zookeeper/2018-09-19-22-10-07.png" alt="" title="">
                </div>
                <div class="image-caption"></div>
            </figure>
</li>
<li><p>delete path [version]<br>删除节点</p>
</li>
</ol>
<p><strong>stat信息</strong><br>cversion = 0       子节点的版本号<br>aclVersion = 0     表示acl的版本号，修改节点权限<br>dataVersion = 1    表示的是当前节点数据的版本号</p>
<p>czxid    节点被创建时的事务ID<br>mzxid   节点最后一次被更新的事务ID<br>pzxid    当前节点下的子节点最后一次被修改时的事务ID</p>
<p>ctime = Sat Aug 05 20:48:26 CST 2017<br>mtime = Sat Aug 05 20:48:50 CST 2017</p>
<p>cZxid = 0x500000015<br>ctime = Sat Aug 05 20:48:26 CST 2017<br>mZxid = 0x500000016<br>mtime = Sat Aug 05 20:48:50 CST 2017<br>pZxid = 0x500000015<br>cversion = 0<br>dataVersion = 1<br>aclVersion = 0<br>ephemeralOwner = 0x0   创建临时节点的时候，会有一个sessionId 。 该值存储的就是这个sessionid<br>dataLength = 3    数据值长度<br>numChildren = 0  子节点数</p>
<h3 id="Java-API"><a href="#Java-API" class="headerlink" title="Java API"></a>Java API</h3><p>权限控制模式<br>schema：授权对象<br>ip     : 192.168.1.1<br>Digest  : username:password<br>world  : 开放式的权限控制模式，数据节点的访问权限对所有用户开放。 world:anyone<br>super  ：超级用户，可以对zookeeper上的数据节点进行操作</p>
<p>连接状态<br>KeeperStat.Expired  在一定时间内客户端没有收到服务器的通知， 则认为当前的会话已经过期了。<br>KeeperStat.Disconnected  断开连接的状态<br>KeeperStat.SyncConnected  客户端和服务器端在某一个节点上建立连接，并且完成一次version、zxid同步<br>KeeperStat.authFailed  授权失败<br>事件类型<br>NodeCreated  当节点被创建的时候，触发<br>NodeChildrenChanged  表示子节点被创建、被删除、子节点数据发生变化<br>NodeDataChanged    节点数据发生变化<br>NodeDeleted        节点被删除<br>None   客户端和服务器端连接状态发生变化的时候，事件类型就是None</p>
<h3 id="zookeeper的实际应用场景"><a href="#zookeeper的实际应用场景" class="headerlink" title="zookeeper的实际应用场景"></a>zookeeper的实际应用场景</h3><ul>
<li>订阅发布<br> watcher机制<br> 统一配置管理（disconf）</li>
<li>分布式锁<br> redis<br> zookeeper<br> 数据库   </li>
</ul>
<ul>
<li>负载均衡</li>
<li>ID生成器</li>
<li>分布式队列</li>
<li>统一命名服务</li>
<li>master选举</li>
</ul>
<ul>
<li>master选举</li>
</ul>
<hr>
<h3 id="zookeeper-集群角色"><a href="#zookeeper-集群角色" class="headerlink" title="zookeeper 集群角色"></a>zookeeper 集群角色</h3><ul>
<li><p>leader</p>
<ol>
<li>事务请求的唯一调度者和处理者，保证集群事务处理的顺序性</li>
<li>集群内部各个服务器的调度者</li>
</ol>
</li>
<li><p>follower</p>
<ol>
<li>处理客户端非事务请求，以及转发事务请求给leader服务器</li>
<li>参与事务请求提议（proposal）的投票（客户端的一个事务请求，需要半数服务器投票通过以后才能通知leader commit； leader会发起一个提案，要求follower投票）</li>
<li>参与leader选举的投票</li>
</ol>
</li>
<li><p>observer<br>观察zookeeper集群中最新状态的变化并将这些状态同步到observer服务器上。增加observer不影响集群中事务处理能力，同时还能提升集群的非事务处理能力</p>
</li>
</ul>
<!-- more -->
<h3 id="zookeeper-集群组成"><a href="#zookeeper-集群组成" class="headerlink" title="zookeeper 集群组成"></a>zookeeper 集群组成</h3><p><strong>一般由2n+1太服务器组成</strong></p>
<h3 id="leader选举"><a href="#leader选举" class="headerlink" title="leader选举"></a>leader选举</h3><p>三种算法：</p>
<ul>
<li>leaderElection</li>
<li>AuthFastLeaderElection </li>
<li>FastLeaderElection（默认）</li>
</ul>
<h4 id="FastLeaderElection-选举流程"><a href="#FastLeaderElection-选举流程" class="headerlink" title="FastLeaderElection 选举流程"></a>FastLeaderElection 选举流程</h4><p>几个概念:</p>
<ul>
<li>serverid : 在配置server集群的时候，给定服务器的标识id（myid）</li>
<li>zxid  : 服务器在运行时产生的数据ID， zxid的值越大，表示数据越新</li>
<li>Epoch: 选举的轮数</li>
<li>server的状态：Looking、 Following、Observering、Leading</li>
</ul>
<p>选举流程，第一次初始化启动的时候服务器状态为Looking</p>
<ul>
<li>所有在集群中的server都会 <strong>推荐自己为leader</strong>，然后 <strong>把（myid、zxid、epoch）作为广播信息</strong>，广播给集群中的其他server, 然后 <strong>等待其他服务器返回</strong></li>
<li>每个服务器都会 <strong>接收来自集群中的其他服务器的投票</strong>。集群中的每个服务器在接受到投票后，开始判断投票的有效性<ul>
<li>判断逻辑时钟(Epoch) ，<strong>如果Epoch大于自己当前的Epoch，说明自己保存的Epoch是过期</strong>。更新Epoch，同时clear其他服务器发送过来的选举数据。判断是否需要更新当前自己的选举情况</li>
<li>如果Epoch小于目前的Epoch，说明对方的epoch过期了，也就意味着对方服务器的选举轮数是过期的。这个时候，只需要讲自己的信息发送给对方</li>
<li>如果epoch等于目前的epoch，根据规则来判断是否有资格获得leader<ul>
<li>接收来自其他服务器的投票后，针对每一个投票，都需要将别人的投票和自己的投票进行PK zxid，zxid最大的服务器优先</li>
</ul>
</li>
</ul>
</li>
</ul>
<p><img src="/2018/09/17/分布式协调服务zookeeper/2018-09-22-11-33-01.png" alt=""></p>

      
    
    </div>
    
      

      
  <hr class="copy-line">
  <div class="post-copyright">
    <div class="copy-author">
      <span>作者 :</span>
      <span>Lincy</span>
    </div>
    <div class="copy-url">
      <span>地址 :</span>
      <a href="https://lincy.online/2018/09/17/分布式协调服务zookeeper/">https://lincy.online/2018/09/17/分布式协调服务zookeeper/</a>
    </div>
    <div class="copy-origin">
      <span>来源 :</span>
      <a href="https://lincy.online">https://lincy.online</a>
    </div>
    <div class="copy-license">
      
      著作权归作者所有，转载请联系作者获得授权。
    </div>
  </div>

    
  </article>
  
    
  <nav class="article-page">
    
      <a href="/2018/09/22/分布式服务zookeeper应用场景/" id="art-left" class="art-left">
        <span class="next-title">
          <i class="iconfont icon-left"></i>分布式服务zookeeper应用场景
        </span>
      </a>
    
    
      <a href="/2018/08/30/分布式通信协议-HTTP/" id="art-right" class="art-right">
        <span class="prev-title"> 
          分布式通信协议-HTTP<i class="iconfont icon-right"></i>  
        </span>
      </a>
    
  </nav>

    
  <i id="com-switch" class="iconfont icon-more jumping-in long infinite" style="font-size:24px;display:block;text-align:center;transform:rotate(180deg);"></i>
  <div class="post-comments" id="post-comments" style="display: block;margin: auto 16px;">
    
    
    

    

  </div>



  
  
    
  
  <aside class="post-toc">
    <span class="title" id="toc-switch"><span>文章导航</span></span>
    <div class="toc-inner syuanpi back-1" style="display:none;">
      <li class="title-link"><a href="javascript:;" class="toTop">分布式协调服务zookeeper</a></li>
      <ol class="toc"><li class="toc-item toc-level-3"><a class="toc-link" href="#分布式环境的特点"><span class="toc-text">分布式环境的特点</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#分布式面临的问题"><span class="toc-text">分布式面临的问题</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#中心化和去中心化"><span class="toc-text">中心化和去中心化</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#CAP-BASE-理论"><span class="toc-text">CAP/BASE 理论</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#CAP"><span class="toc-text">CAP</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#BASE"><span class="toc-text">BASE</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zookeeper能做什么"><span class="toc-text">zookeeper能做什么</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zookeeper的特性"><span class="toc-text">zookeeper的特性</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zookeeper-安装"><span class="toc-text">zookeeper 安装</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#单机环境安装"><span class="toc-text">单机环境安装</span></a></li><li class="toc-item toc-level-4"><a class="toc-link" href="#集群环境"><span class="toc-text">集群环境</span></a></li></ol></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zookeeper-的一些概念"><span class="toc-text">zookeeper 的一些概念</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zookee-的命令操作"><span class="toc-text">zookee 的命令操作</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#Java-API"><span class="toc-text">Java API</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zookeeper的实际应用场景"><span class="toc-text">zookeeper的实际应用场景</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zookeeper-集群角色"><span class="toc-text">zookeeper 集群角色</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#zookeeper-集群组成"><span class="toc-text">zookeeper 集群组成</span></a></li><li class="toc-item toc-level-3"><a class="toc-link" href="#leader选举"><span class="toc-text">leader选举</span></a><ol class="toc-child"><li class="toc-item toc-level-4"><a class="toc-link" href="#FastLeaderElection-选举流程"><span class="toc-text">FastLeaderElection 选举流程</span></a></li></ol></li></ol>
    </div>
  </aside>



  


        </div>
      </main>

      <footer class="footer syuanpi fadeIn" id="footer">
  <hr>
  <div class="footer-wrapper">
    <div class="left">
      <div class="contact-icon">
    
    
    
    
    
    
    
    
        
        
        
        
        
            <a href="https://www.facebook.com/1" class="iconfont icon-facebook" title="facebook"></a>
        
        
        
    
        
        
        
            <a href="https://twitter.com/2" class="iconfont icon-twitter" title="twitter"></a>
        
        
        
        
        
    
        
        
        
        
        
        
        
            <a href="https://www.instagram.com/3" class="iconfont icon-ins" title="instagram"></a>
        
    
        
        
            <a href="https://weibo.com/4" class="iconfont icon-weibo" title="weibo"></a>
        
        
        
        
        
        
    
        
        
        
        
            <a href="https://www.zhihu.com/people/5" class="iconfont icon-zhihu" title="zhihu"></a>
        
        
        
        
    
        
            <a href="https://github.com/6" class="iconfont icon-github" title="github"></a>
        
        
        
        
        
        
        
    
        
        
        
        
        
        
            <a href="https://www.linkedin.com/in/7" class="iconfont icon-linkedin" title="linkedin"></a>
        
        
    
</div>
    </div>
    <div class="right">
      <div class="copyright">
    <div class="info">
        <span>&copy;</span>
        <span>2016 ~ 2018</span>
        <span>❤</span>
        <span>Lincy</span>
    </div>
    <div class="theme">
        <span>
            动力来源于
            <a href="http://hexo.io/" target="_blank">Hexo </a>
        </span>
        <span>
            主题
            <a href="https://github.com/ColMugX/hexo-theme-Nlvi"> Nlvi </a>
        </span>
    </div>
    
</div>

    </div>
  </div>
</footer>
    </div>
  </div>
  <script src="/script/lib/jquery/jquery-3.2.1.min.js"></script>


  <script src="/script/lib/lightbox/js/lightbox.min.js"></script>








<script src="/script/src/nlvi.js"></script>

  <script src="/script/scheme/banderole.js"></script>

<script src="/script/bootstarp.js"></script>


<div class="backtop syuanpi melt toTop" id="backtop">
    <i class="iconfont icon-up"></i>
    <span style="text-align:center;font-family:Georgia;"><span style="font-family:Georgia;" id="scrollpercent">1</span>%</span>
</div>


  <div class="search" id="search">
    <div class="mask" id="mask"></div>
    <div class="search-wrapper syuanpi">
      <h2 id="search-header" class="syuanpi">搜索一下？</h2>
      <div class="input">
        <input type="text" id="local-search-input" results="0" name="">
      </div>
      <div id="local-search-result"></div>
    </div>
  </div>


</body>
</html>
